{% set pagetitle = 'Nuclei Test'|trans %}
{% extends "base.twig" %}

{% block preload %}
  <link rel="stylesheet" href="{{ asset('css/src/default.css', 'conformance') }}">
{% endblock %}

{% block content %}
  <h1>{{ pagetitle }}</h1>

  <div class="form-container">
    <form method="post">
      <div class="form-group">
        <label for="testTypeId">Test type</label>
        <select id="testTypeId" name="Test type">
          <option value="standardResponse" selected>Standard response</option>
          <option value="noSignature">No signature</option>
          <option value="invalidSignature">Invalid signature</option>
        </select>
      </div>

      <div class="form-group">
        <label for="serviceProviderEntityId">Service Provider (SP)</label>
        <select id="serviceProviderEntityId">
          {% for entityId, serviceProvider in serviceProviders %}
          <option value="{{ entityId }}">{{ entityId }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="assertionConsumerServiceUrl">Assertion Consumer Service (ACS, optional)</label>
        <select id="assertionConsumerServiceUrl">
          <option value="" selected></option>
        </select>
        <span class="help">
          If you need to test specific ACS, select it from here. Otherwise, you can leave it empty to resolve it
          automatically.
        </span>
      </div>

      <div class="form-group">
        <label for="enableDebug">
          <input type="checkbox" id="enableDebug">
          Show all requests and responses?
        </label>

        <label for="enableVerbose">
          <input type="checkbox" id="enableVerbose">
          Show verbose output?
        </label>

        <label for="enableFindingsExport">
          <input type="checkbox" id="enableFindingsExport">
          Export findings to a file?
        </label>

        <label for="enableJsonExport">
          <input type="checkbox" id="enableJsonExport">
          Export results in JSON format?
        </label>

        <label for="enableJsonLExport">
          <input type="checkbox" id="enableJsonLExport">
          Export results in JSONL(ine) format?
        </label>

        <label for="enableSarifExport">
          <input type="checkbox" id="enableSarifExport">
          Export results in SARIF format?
        </label>

        <label for="enableMarkdownExport">
          <input type="checkbox" id="enableMarkdownExport">
          Export results in Markdown format?
        </label>

      </div>

      <div class="form-group">
        <button id="nuclei-run-test-btn" type="button">Run</button>
      </div>
    </form>
  </div>

  <div class="cmd-output">
    <pre id="cmd-output">{{ output ?? 'Waiting for test initialization.' }}</pre>
  </div>

{% endblock %}

{% block foot %}
<div>
  <input type="hidden" id="canRunTest" value="{{ canRunTest }}">
</div>
{% endblock %}

{% block postload %}
  <script src="{{ asset('js/src/nuclei-test-run.js', 'conformance') }}"></script>
{% endblock %}